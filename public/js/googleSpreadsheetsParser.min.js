var GoogleSpreadsheetsParser,GoogleSpreadsheetsUtil;
GoogleSpreadsheetsUtil=function(){function f(){}f.prototype.extractKey=function(c){c=c.match(/https:\/\/docs.google.com\/spreadsheets\/d\/(.+)\/pubhtml/);return null===c||2!==c.length?null:c[1]};f.prototype.getWorksheetId=function(c,b){var a,e,d,f;a=new XMLHttpRequest;a.open("GET","https://spreadsheets.google.com/feeds/worksheets/"+c+"/public/basic?alt=json",!1);a.send();d=[];if(200===a.status)if(a=JSON.parse(a.responseText),b)for(e in f=a.feed.entry,f){if(a=f[e],a.title.$t===b){d=a.id.$t.match(/https:\/\/spreadsheets.google.com\/feeds\/worksheets\/.+\/public\/basic\/(.+)/);
break}}else d=a.feed.entry[0].id.$t.match(/https:\/\/spreadsheets.google.com\/feeds\/worksheets\/.+\/public\/basic\/(.+)/);return null===d||2!==d.length?null:d[1]};f.prototype.getFeeds=function(c,b){var a,e;e=new XMLHttpRequest;e.open("GET","https://spreadsheets.google.com/feeds/cells/"+c+"/"+b+"/public/values?alt=json",!1);e.send();a=null;200===e.status&&(a=JSON.parse(e.responseText));return a};f.prototype.makeTitle=function(c){var b,a,e,d;d=[];a=0;for(e=c.length;a<e;a++){b=c[a];b=b.gs$cell;if(null===
b)break;if(1===Number(b.row))d.push(b.$t);else break}return d};f.prototype.makeContents=function(c){var b,a,e,d,f,g,h;e=[];if(!(1<=c.length&&c[0].gs$cell))return e;a=Number(c[c.length-1].gs$cell.col);d=h=0;for(f=c.length;d<f;d++)b=c[d],b=b.gs$cell,1!==Number(b.row)&&(b.row!==h&&(h=b.row,g=[]),g.push(b.$t),Number(b.col)===a&&(e.push(g),g=[]));return e};return f}();
GoogleSpreadsheetsParser=function(){return function(f,c){var b,a,e,d;d=c.sheetTitle||null;e=c.hasTitle||!0;b=new GoogleSpreadsheetsUtil;a=b.extractKey(f);d=b.getWorksheetId(a,d);a=b.getFeeds(a,d).feed.entry;e&&(this.titles=b.makeTitle(a));this.contents=b.makeContents(a)}}();
